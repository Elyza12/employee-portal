<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Awi Employee Portal</title>
<style>
    body { font-family: Arial,sans-serif; background:#f4f4f4; margin:0; padding:0; }
    header { background:#0077cc; color:white; padding:20px; text-align:center; }
    section { display:none; padding:20px; max-width:900px; margin:20px auto; background:white; border-radius:8px; box-shadow:0 0 10px #ccc; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td { border:1px solid #ddd; padding:10px; text-align:left; }
    th { background:#0077cc; color:white; }
    td { background:#f9f9f9; }
    input, textarea { width:100%; padding:10px; margin:5px 0; box-sizing:border-box; }
    button { background:#0077cc; color:white; border:none; padding:12px; cursor:pointer; width:100%; margin-top:10px; border-radius:5px; font-size:16px; }
    button:hover { background:#005fa3; }
    img.schedule { width:100%; max-width:1000px; border:1px solid #ccc; border-radius:8px; margin-top:10px; }
</style>
</head>
<body>
<header>Awi Employee Portal</header>

<!-- Login Section -->
<section id="login">
    <h2>Login</h2>
    <form id="loginForm">
        <input type="text" id="username" placeholder="First Name" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit">Login</button>
    </form>
    <p id="loginMessage" style="color:red;"></p>
</section>

<!-- Employee Portal -->
<section id="portal">
    <h2>Welcome, <span id="employeeName"></span></h2>

    <h3>Work Schedule</h3>
    <img src="schedule.png" alt="Schedule" class="schedule">

    <h3>Incident Reports</h3>
    <table id="irTable">
        <tr>
            <th>Date</th><th>Incident</th><th>Status</th><th>Note</th>
        </tr>
    </table>
    <p><em>Note: All IRs are renewed after 6 months from the incident date.</em></p>

    <h3>Leave Request</h3>
    <input type="text" id="leaveDate" placeholder="Leave Date(s) e.g., Jan 26-28, 2026">
    <textarea id="leaveReason" placeholder="Reason for Leave"></textarea>
    <button onclick="submitLeave()">Submit Leave</button>

    <h4>Your Leave Requests</h4>
    <table id="leaveTable">
        <tr><th>Date(s)</th><th>Reason</th><th>Status</th></tr>
    </table>

    <input type="password" id="newPassword" placeholder="New Password">
    <button onclick="changePassword()">Update Password</button>
    <button style="margin-top:20px;" onclick="logout()">Logout</button>
</section>

<!-- Admin Portal -->
<section id="adminPortal">
    <h2>Admin Panel - Leave Requests</h2>
    <table id="adminLeaveTable">
        <tr><th>Employee</th><th>Date(s)</th><th>Reason</th><th>Status</th><th>Action</th></tr>
    </table>
    <button onclick="logout()">Logout</button>
</section>

<script>
document.addEventListener("DOMContentLoaded", function(){

    // Employee data
    const employees = {
        'eliza': { password:'1234', irs:[], leaves:[] },
        'rachelle': { password:'1234', irs:[], leaves:[] },
        'admin': { password:'1234', irs:[], leaves:[] } // Admin account
    };

    let currentUser = '';

    const loginForm = document.getElementById('loginForm');
    loginForm.addEventListener('submit', function(e){
        e.preventDefault();
        const user = document.getElementById('username').value.trim().toLowerCase();
        const pass = document.getElementById('password').value;

        if(employees[user] && employees[user].password===pass){
            currentUser = user;
            document.getElementById('login').style.display='none';
            if(user==='admin'){
                document.getElementById('adminPortal').style.display='block';
                loadAdminLeaves();
            } else {
                document.getElementById('portal').style.display='block';
                document.getElementById('employeeName').innerText = user.charAt(0).toUpperCase()+user.slice(1);
                loadLeaves();
            }
        } else {
            document.getElementById('loginMessage').innerText='Invalid username or password';
        }
    });

    // Logout
    window.logout = function(){
        currentUser='';
        document.getElementById('portal').style.display='none';
        document.getElementById('adminPortal').style.display='none';
        document.getElementById('login').style.display='block';
        document.getElementById('username').value='';
        document.getElementById('password').value='';
        document.getElementById('loginMessage').innerText='';
    }

    // Change Password
    window.changePassword = function(){
        const newPass = document.getElementById('newPassword').value;
        if(!newPass){
            alert('Enter a new password');
            return;
        }
        if(newPass===employees[currentUser].password){
            alert('New password must be different from the old one');
            return;
        }
        employees[currentUser].password = newPass;
        alert('Password updated successfully!');
        document.getElementById('newPassword').value='';
    }

    // Submit Leave
    window.submitLeave = function(){
        const date = document.getElementById('leaveDate').value.trim();
        const reason = document.getElementById('leaveReason').value.trim();
        if(!date || !reason){
            alert('Enter leave date and reason');
            return;
        }
        employees[currentUser].leaves.push({ date, reason, status:'Pending' });
        document.getElementById('leaveDate').value='';
        document.getElementById('leaveReason').value='';
        loadLeaves();
        loadAdminLeaves();
        alert('Leave submitted successfully!');
    }

    // Load employee leave table
    function loadLeaves(){
        const table = document.getElementById('leaveTable');
        table.innerHTML = '<tr><th>Date(s)</th><th>Reason</th><th>Status</th></tr>';
        employees[currentUser].leaves.forEach(l=>{
            const row = table.insertRow();
            row.insertCell(0).innerText = l.date;
            row.insertCell(1).innerText = l.reason;
            row.insertCell(2).innerText = l.status;
        });
    }

    // Admin view
    function loadAdminLeaves(){
        const table = document.getElementById('adminLeaveTable');
        table.innerHTML = '<tr><th>Employee</th><th>Date(s)</th><th>Reason</th><th>Status</th><th>Action</th></tr>';
        for(const emp in employees){
            if(emp==='admin') continue;
            employees[emp].leaves.forEach((l, i)=>{
                const row = table.insertRow();
                row.insertCell(0).innerText = emp.charAt(0).toUpperCase()+emp.slice(1);
                row.insertCell(1).innerText = l.date;
                row.insertCell(2).innerText = l.reason;
                row.insertCell(3).innerText = l.status;
                const actionCell = row.insertCell(4);
                const approveBtn = document.createElement('button');
                approveBtn.innerText = 'Approve';
                approveBtn.onclick = () => { l.status='Approved'; loadLeaves(); loadAdminLeaves(); };
                const rejectBtn = document.createElement('button');
                rejectBtn.innerText = 'Reject';
                rejectBtn.style.background='#cc0000';
                rejectBtn.onclick = () => { l.status='Rejected'; loadLeaves(); loadAdminLeaves(); };
                actionCell.appendChild(approveBtn);
                actionCell.appendChild(rejectBtn);
            });
        }
    }

    document.getElementById('login').style.display='block';
});
</script>
</body>
</html>
